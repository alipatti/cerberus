services:
  coordinator:
    env_file: .env
    build:
      context: .
      target: coordinator

  moderator:
    scale: ${CERBERUS_N_MODERATORS} # this works despite the linter error. see: https://linuxhint.com/docker_compose_scale/
    build:
      context: .
      target: moderator
